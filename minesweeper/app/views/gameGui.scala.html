@(controller:de.htwg.se.minesweeper.controller.controller.Controller,
  gameState: String
)

@import helper._
@import de.htwg.se.minesweeper.model.Symbols

@main("Minesweeper GUI") {
    <link rel="stylesheet" href="@routes.Assets.versioned("stylesheets/main.css")">
    <script src="@routes.Assets.versioned("javascripts/main.js")"> </script>

    <h1 id="title">Minesweeper Game</h1>

    <div id="difficulty">
        <a href='@routes.HomeController.setDifficulty("E")' class="difficulty-link">Easy</a> |
        <a href='@routes.HomeController.setDifficulty("M")' class="difficulty-link">Medium</a> |
        <a href='@routes.HomeController.setDifficulty("H")' class="difficulty-link">Hard</a>
    </div>

    <script>
        const gameState = "@gameState";

        let gameOverHandled = false;

        if ((gameState === "Lost" || gameState === "Won") && !gameOverHandled) {
            displayBombs();
            gameOverHandled = true;
        }
    </script>

    <table id="gameBoard">
        @for(y <- 0 until controller.field.size) {
            <tr class="game-row">
                @for(x <- 0 until controller.field.size) {
                    <td class="cell covered" data-x="@y" data-y="@x"
                        onclick="uncoverCell(@y, @x)"
                        oncontextmenu="flagCell(@y, @x); return false;">
                        <!-- Der tatsÃ¤chliche Inhalt wird mit CSS verborgen -->
                        <span class="cell-content">
                            @{
                                controller.field.cell(x, y) match {
                                    case Symbols.Covered => Html("")
                                    case Symbols.Flag => Html("ðŸš©")
                                    case Symbols.Bomb => Html("ðŸ’£")
                                    case Symbols.Empty => Html("&nbsp;")
                                    case number => Html(number.toString)
                                }
                            }
                        </span>
                    </td>
                }
            </tr>
        }
    </table>

    <div id="controls">
        <a href='@routes.HomeController.undo()' class="button">Undo</a>
        <a href='@routes.HomeController.restart()' class="button">Restart</a>
        <a href='@routes.HomeController.saveGame()' class="button">Save Game</a>
        <a href='@routes.HomeController.loadGamePage()' class="button">Load Game</a>
    </div>
}