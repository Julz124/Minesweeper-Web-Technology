@(controller:de.htwg.se.minesweeper.controller.controller.Controller, gameState: String)

@import helper._
@import de.htwg.se.minesweeper.model.Symbols

@main("Minesweeper GUI") {
    <link rel="stylesheet" href="@routes.Assets.versioned("stylesheets/main.css")">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="@routes.Assets.versioned("javascripts/main.js")"></script>

    <!-- Video-Hintergrund -->
    <div id="video-background">
        <video autoplay loop muted playsinline>
            <source src="../assets/Minesweeper.mp4" type="video/mp4">
            Ihr Browser unterst√ºtzt das Video-Tag nicht.
        </video>
    </div>

    <!-- Graue Leiste oben -->
    <header>
        <nav id="top-nav">
            <a href="@routes.HomeController.gameHomepage()" id="logo">Minesweeper</a>
        </nav>
    </header>

    <!-- Hauptinhalt f√ºr das Spiel -->
    <div id="content" class="@gameState">
        <div id="difficulty">
            <a href='@routes.HomeController.setDifficulty("E")' class="btn-custom mx-2">Easy</a>
            <a href='@routes.HomeController.setDifficulty("M")' class="btn-custom mx-2">Medium</a>
            <a href='@routes.HomeController.setDifficulty("H")' class="btn-custom mx-2">Hard</a>
        </div>

        <script>
            const gameState = "@gameState";

            let gameOverHandled = false;

            if ((gameState === "Lost" || gameState === "Won") && !gameOverHandled) {
                displayBombs();
                gameOverHandled = true;
            }
        </script>

        <div id="gameBoard">
            @for(y <- 0 until controller.field.size) {
                <div class="game-row">
                    @for(x <- 0 until controller.field.size) {
                        <div class="cell covered" data-x="@y" data-y="@x"
                            onclick="uncoverCell(@y, @x)"
                            oncontextmenu="flagCell(@y, @x); return false;">
                            <span class="cell-content">
                                @{
                                    controller.field.cell(x, y) match {
                                        case Symbols.Covered => Html("")
                                        case Symbols.Flag => Html("üö©")
                                        case Symbols.Bomb => Html("üí£")
                                        case Symbols.Empty => Html("&nbsp;")
                                        case number => Html(number.toString)
                                    }
                                }
                            </span>
                        </div>
                    }
                </div>
            }
        </div>

        <div id="controls">
            <a href='@routes.HomeController.undo()' class="btn-custom mx-2">Undo</a>
            <a href='@routes.HomeController.restart()' class="btn-custom mx-2">Restart</a>
            <a href='@routes.HomeController.saveGame()' class="btn-custom mx-2">Save Game</a>
            <a href='@routes.HomeController.loadGamePage()' class="btn-custom mx-2">Load Game</a>
        </div>
    </div>
}
